.. include:: ./substitutions.rst

Plotting - matplotlib
=====================

A collection of functions for plotting results using matplotlib_ as the backend.


Wrappers
--------

These functions provide a high-level API for visualizing various objects/results (e.g., :class:`~pyimpspec.data.DataSet`).

.. automodule:: pyimpspec.mpl
   :members: plot_circuit, plot_data, plot_drt, plot_fit, plot_tests



Primitives
----------

These functions are used by the wrapper functions to make a more complex figure with multiple subplots.

.. automodule:: pyimpspec.mpl
   :members: plot_bht_scores, plot_bode, plot_complex, plot_gamma, plot_imaginary, plot_magnitude, plot_mu_xps, plot_nyquist, plot_phase, plot_real, plot_residuals


Examples
--------

Below are some examples of plots created using the plotting functions listed above.
The circuit and the data set are based on test circuit 1 (TC-1) from this 1995 article by `Bernard Boukamp`_.

Legends are disabled and colored axes are used instead in the figures generated by the wrapper functions (i.e., the first figure in each series).
This has been done due to the small size of the figures in this documentation.
However, the figures generated by the individual primitive functions are also included with the legends enabled and without colored axes.

The default color scheme is based on the *Vibrant qualitative* color scheme presented in `Paul Tol`_'s blog.
Colors and markers can be defined when calling any of the functions.

.. _Bernard Boukamp: https://doi.org/10.1149/1.2044210
.. _Paul Tol: https://personal.sron.nl/~pault/

plot_circuit
~~~~~~~~~~~~
:func:`~pyimpspec.mpl.plot_circuit`

* :func:`~pyimpspec.mpl.plot_nyquist`
* :func:`~pyimpspec.mpl.plot_bode`

.. plot::

  import pyimpspec
  from pyimpspec import mpl
  from pyimpspec.mock_data import EXAMPLE, TC1
  import matplotlib.pyplot as plt
  from numpy import logspace, log10 as log

  f = EXAMPLE.get_frequencies()
  figure, axes = mpl.plot_circuit(TC1, frequencies=f, label="TC-1", title="", legend=False, colored_axes=True)
  figure.tight_layout()
  plt.show()

  data = pyimpspec.simulate_spectrum(
    TC1,
    logspace(
      log(max(f)),
      log(min(f)),
      num=int(log(max(f)) - log(min(f))) * 100 + 1,
    ),
    label="TC-1",
  )
  figure, axes = mpl.plot_nyquist(data, line=True)
  figure.tight_layout()
  plt.show()

  figure, axes = mpl.plot_bode(data, line=True)
  figure.tight_layout()
  plt.show()

.. raw:: latex

    \clearpage


plot_data
~~~~~~~~~
:func:`~pyimpspec.mpl.plot_data`

* :func:`~pyimpspec.mpl.plot_nyquist`
* :func:`~pyimpspec.mpl.plot_bode`

.. plot::

  import pyimpspec
  from pyimpspec import mpl
  from pyimpspec.mock_data import EXAMPLE
  import pyimpspec.plot.colors as colors
  import matplotlib.pyplot as plt

  figure, axes = mpl.plot_data(EXAMPLE, legend=False, colored_axes=True)
  figure.tight_layout()
  plt.show()

  figure, axes = mpl.plot_nyquist(EXAMPLE)
  figure.tight_layout()
  plt.show()

  figure, axes = mpl.plot_bode(EXAMPLE)
  figure.tight_layout()
  plt.show()

.. raw:: latex

    \clearpage


plot_drt
~~~~~~~~
:func:`~pyimpspec.mpl.plot_drt`

* :func:`~pyimpspec.mpl.plot_complex`
* :func:`~pyimpspec.mpl.plot_gamma`
* :func:`~pyimpspec.mpl.plot_residuals`

.. plot::

  import pyimpspec
  from pyimpspec import mpl
  from pyimpspec.mock_data import EXAMPLE
  import pyimpspec.plot.colors as colors
  import matplotlib.pyplot as plt

  drt = pyimpspec.calculate_drt_tr_nnls(EXAMPLE)
  figure, axes = mpl.plot_drt(
    drt,
    EXAMPLE,
    legend=False,
    colored_axes=True,
  )
  figure.tight_layout()
  plt.show()

  figure, axes = mpl.plot_complex(
    EXAMPLE,
    colors={
      "real": colors.COLOR_BLACK,
      "imaginary": colors.COLOR_BLACK,
    },
    legend=False,
  )
  _ = mpl.plot_complex(
    drt,
    line=True,
    figure=figure,
    axes=axes,
  )
  figure.tight_layout()
  plt.show()

  figure, axes = mpl.plot_gamma(drt)
  figure.tight_layout()
  plt.show()


  figure, axes = mpl.plot_residuals(drt)
  figure.tight_layout()
  plt.show()

.. raw:: latex

    \clearpage


plot_fit
~~~~~~~~
:func:`~pyimpspec.mpl.plot_fit`

* :func:`~pyimpspec.mpl.plot_nyquist`
* :func:`~pyimpspec.mpl.plot_bode`
* :func:`~pyimpspec.mpl.plot_residuals`

.. plot::

  import pyimpspec
  from pyimpspec import mpl
  from pyimpspec.mock_data import EXAMPLE
  import pyimpspec.plot.colors as colors
  import matplotlib.pyplot as plt

  circuit = pyimpspec.parse_cdc("R(RC)(RW)")
  fit = pyimpspec.fit_circuit(circuit, data=EXAMPLE)

  figure, axes = mpl.plot_fit(
    fit,
    EXAMPLE,
    legend=False,
    colored_axes=True,
  )
  figure.tight_layout()
  plt.show()

  figure, axes = mpl.plot_nyquist(
    EXAMPLE,
    colors={"impedance": colors.COLOR_BLACK},
    legend=False,
  )
  _ = mpl.plot_nyquist(
    fit,
    line=True,
    figure=figure,
    axes=axes,
  )
  figure.tight_layout()
  plt.show()

  figure, axes = mpl.plot_bode(
    EXAMPLE,
    colors={
      "magnitude": colors.COLOR_BLACK,
      "phase": colors.COLOR_BLACK,
    },
    legend=False,
  )
  _ = mpl.plot_bode(
    fit,
    line=True,
    figure=figure,
    axes=axes,
  )
  figure.tight_layout()
  plt.show()

  figure, axes = mpl.plot_residuals(fit)
  figure.tight_layout()
  plt.show()

.. raw:: latex

    \clearpage


plot_tests
~~~~~~~~~~
:func:`~pyimpspec.mpl.plot_tests`

* :func:`~pyimpspec.mpl.plot_mu_xps`
* :func:`~pyimpspec.mpl.plot_residuals`
* :func:`~pyimpspec.mpl.plot_nyquist`
* :func:`~pyimpspec.mpl.plot_bode`

.. plot::

  import pyimpspec
  from pyimpspec import mpl
  from pyimpspec.mock_data import EXAMPLE
  import pyimpspec.plot.colors as colors
  import matplotlib.pyplot as plt

  mu_criterion = 0.85
  tests = pyimpspec.perform_exploratory_tests(
    EXAMPLE,
    mu_criterion=mu_criterion,
    add_capacitance=True,
  )

  figure, axes = mpl.plot_tests(
    tests,
    mu_criterion,
    EXAMPLE,
    legend=False,
    colored_axes=True,
  )
  figure.tight_layout()
  plt.show()

  figure, axes = mpl.plot_mu_xps(
    tests,
    mu_criterion,
  )
  figure.tight_layout()
  plt.show()

  figure, axes = mpl.plot_residuals(tests[0])
  figure.tight_layout()
  plt.show()

  figure, axes = mpl.plot_nyquist(
    EXAMPLE,
    colors={"impedance": colors.COLOR_BLACK},
    legend=False,
  )
  _ = mpl.plot_nyquist(
    tests[0],
    line=True,
    figure=figure,
    axes=axes,
  )
  figure.tight_layout()
  plt.show()

  figure, axes = mpl.plot_bode(
    EXAMPLE,
    colors={
      "magnitude": colors.COLOR_BLACK,
      "phase": colors.COLOR_BLACK,
    },
    legend=False,
  )
  _ = mpl.plot_bode(
    tests[0],
    line=True,
    figure=figure,
    axes=axes,
  )
  figure.tight_layout()
  plt.show()

.. raw:: latex

    \clearpage
